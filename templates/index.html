<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Robota.tej</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <nav class="navbar">
        <div class="container nav-content">
            <div class="logo">üêê Robota.tej</div>
            <a href="/stats" class="btn-stats">üìä Statystyki</a>
        </div>
    </nav>

    <header class="hero">
        <div class="container">
            <div class="count-badge">Baza zawiera {{ total_items }} ofert</div>
            <h1>Znale≈∫li≈õmy <strong>{{ total_items }}</strong> ofert dla Ciebie</h1>
            
            <form action="/" method="get" class="search-bar">
                <input type="hidden" name="sort" value="{{ current_sort }}">
                <input type="text" name="query" placeholder="Czego szukasz?" value="{{ current_query }}">
                <select name="source">
                    <option value="">Wszystkie ≈∫r√≥d≈Ça</option>
                    {% for src in sources %}
                    <option value="{{ src }}" {% if current_source == src %}selected{% endif %}>{{ src }}</option>
                    {% endfor %}
                </select>
                <button type="submit">Szukaj</button>
            </form>

            {% if quick_filters %}
            <div class="quick-filters">
                <span class="label">Popularne:</span>
                {% for f in quick_filters %}
                <a href="/?query={{ f }}&sort={{ current_sort }}" class="filter-chip">{{ f }}</a>
                {% endfor %}
            </div>
            {% endif %}

            {% if current_query or current_source %}
            <div class="clear-wrapper">
                <a href="/" class="clear-chip">Wyczy≈õƒá wszystko √ó</a>
            </div>
            {% endif %}
        </div>
    </header>

    <main class="container">
        <div class="table-controls">
            <div class="sorting-links">
                <a href="{{ url_for('index', sort='newest', query=current_query, source=current_source) }}" 
                   class="sort-link {% if current_sort == 'newest' %}active{% endif %}">Najnowsze</a>
                <a href="{{ url_for('index', sort='alpha', query=current_query, source=current_source) }}" 
                   class="sort-link {% if current_sort == 'alpha' %}active{% endif %}">Alfabetycznie A-Z</a>
            </div>
            <div class="page-indicator">
                Strona <strong>{{ page }}</strong> z {{ total_pages }}
            </div>
        </div>

        <div class="table-wrapper">
            <table>
                <thead>
                    <tr>
                        <th>Stanowisko</th>
                        <th class="text-right">≈πr√≥d≈Ço</th>
                    </tr>
                </thead>
                <tbody>
                    {% for offer in offers %}
                    <tr>
                        <td><a href="{{ offer.link }}" target="_blank" class="job-link">{{ offer.title }}</a></td>
                        <td class="text-right">
                            <span class="badge {{ offer.source_site|lower|replace('.', '') }}">{{ offer.source_site }}</span>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>

        {% if total_pages > 1 %}
        <div class="pagination-container">
            <div class="pagination-pill">
                {% if page > 1 %}
                <a href="{{ url_for('index', page=1, query=current_query, source=current_source, sort=current_sort) }}" class="nav-arrow">Pierwsza</a>
                <a href="{{ url_for('index', page=page-1, query=current_query, source=current_source, sort=current_sort) }}" class="nav-arrow">¬´</a>
                {% endif %}

                <div class="page-numbers">
                    {% for p in page_range %}
                    <a href="{{ url_for('index', page=p, query=current_query, source=current_source, sort=current_sort) }}" 
                       class="p-num {% if p == page %}active{% endif %}">{{ p }}</a>
                    {% endfor %}
                </div>
                
                {% if page < total_pages %}
                <a href="{{ url_for('index', page=page+1, query=current_query, source=current_source, sort=current_sort) }}" class="nav-arrow">¬ª</a>
                <a href="{{ url_for('index', page=total_pages, query=current_query, source=current_source, sort=current_sort) }}" class="nav-arrow">Ostatnia</a>
                {% endif %}
            </div>
        </div>
        {% endif %}
    </main>
</body>
</html>